//////////////////////////////////////////////////////////////////////
// mysql.go
//////////////////////////////////////////////////////////////////////
package mysql

import (
    "database/sql"
    _ "github.com/go-sql-driver/mysql"
)


const (
    DRIVER_NAME = "mysql"
)


var (
    myDb *sql.DB
)


//////////////////////////////////////////////////////////////////////
// Close database.
//////////////////////////////////////////////////////////////////////
func Close() {
    if myDb != nil {
        myDb.Close()
    }
}


//////////////////////////////////////////////////////////////////////
// Connect to the database.
//////////////////////////////////////////////////////////////////////
func Conn() *sql.DB {
    return myDb
}


//////////////////////////////////////////////////////////////////////
// Initialize with data source name.
//////////////////////////////////////////////////////////////////////
func InitWithDataSourceName(dataSourceName string) error {
    db, err := sql.Open(DRIVER_NAME, dataSourceName)
    if err != nil {
        return err
    }
    if err := db.Ping(); err != nil {
        db.Close()
        return err
    }
    myDb = db
    return nil
}






